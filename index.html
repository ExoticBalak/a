<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QR Code Generator</title>
  <script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
  <style>
    :root {
      --color-bg-light: #f4f4f8;
      --color-bg-dark: #1a1a1d;
      --color-card-light: rgba(255, 255, 255, 0.75);
      --color-card-dark: rgba(40, 40, 40, 0.75);
      --color-text-light: #222;
      --color-text-dark: #eee;
      --blur: 20px;
      --radius: 16px;
      --accent: #00c3ff;
    }

    [data-theme="dark"] {
      --bg: var(--color-bg-dark);
      --text: var(--color-text-dark);
      --card: var(--color-card-dark);
    }

    [data-theme="light"] {
      --bg: var(--color-bg-light);
      --text: var(--color-text-light);
      --card: var(--color-card-light);
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: "Segoe UI", sans-serif;
      margin: 0;
      padding: 2rem;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      transition: all 0.3s ease;
    }

    .card {
      background: var(--card);
      backdrop-filter: blur(var(--blur));
      -webkit-backdrop-filter: blur(var(--blur));
      border-radius: var(--radius);
      padding: 2rem;
      max-width: 400px;
      width: 100%;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.1);
    }

    h1 {
      text-align: center;
      font-size: 1.8rem;
      margin-bottom: 1rem;
      color: var(--accent);
    }

    input, select, button {
      width: 100%;
      padding: 0.75rem;
      margin: 0.4rem 0;
      font-size: 1rem;
      border: none;
      border-radius: 10px;
      background: #fff;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    }

    button {
      background: var(--accent);
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    button:hover {
      background: #009ec7;
    }

    #qr-container {
      margin-top: 1rem;
      text-align: center;
    }

    .theme-toggle {
      margin-top: 1rem;
      background: none;
      border: 2px solid var(--accent);
      color: var(--accent);
    }

    input[type="color"] {
      height: 45px;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>QR Generator</h1>

    <select id="qrType" onchange="toggleFields(); updateQR();">
      <option value="text">Text / URL</option>
      <option value="wifi">WiFi</option>
      <option value="email">Email</option>
      <option value="sms">SMS</option>
      <option value="phone">Phone</option>
    </select>

    <div id="qrFields"></div>

    <input id="qrLabel" type="text" placeholder="Label (optional)" oninput="updateQR()" />
    <label>Foreground</label>
    <input id="qrColor" type="color" value="#000000" onchange="updateQR()" />
    <label>Background</label>
    <input id="bgColor" type="color" value="#ffffff" onchange="updateQR()" />

    <input type="file" accept="image/*" onchange="loadLogo(this)" />

    <button onclick="downloadQR('png')">Download PNG</button>
    <button onclick="downloadQR('svg')">Download SVG</button>
    <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>

    <div id="qr-container"></div>
    <p id="qr-label-output"></p>
  </div>

  <script>
    let qr = new QRCodeStyling({
      width: 220,
      height: 220,
      data: "",
      dotsOptions: { color: "#000", type: "rounded" },
      backgroundOptions: { color: "#fff" },
      imageOptions: { crossOrigin: "anonymous", margin: 4 },
    });

    function getInputValue() {
      const type = document.getElementById("qrType").value;
      if (type === "text") {
        return document.getElementById("qrText").value.trim();
      } else if (type === "wifi") {
        const ssid = document.getElementById("wifiSSID").value.trim();
        const pass = document.getElementById("wifiPass").value.trim();
        const sec = document.getElementById("wifiSec").value;
        return `WIFI:S:${ssid};T:${sec};P:${pass};;`;
      } else if (type === "email") {
        const email = document.getElementById("emailTo").value.trim();
        const subject = document.getElementById("emailSubject").value.trim();
        return `mailto:${email}?subject=${encodeURIComponent(subject)}`;
      } else if (type === "sms") {
        const phone = document.getElementById("smsNum").value.trim();
        const msg = document.getElementById("smsMsg").value.trim();
        return `sms:${phone}?body=${encodeURIComponent(msg)}`;
      } else if (type === "phone") {
        return `tel:${document.getElementById("phoneNum").value.trim()}`;
      }
      return "";
    }

    function updateQR() {
      const data = getInputValue();
      const color = document.getElementById("qrColor").value;
      const bgColor = document.getElementById("bgColor").value;
      const label = document.getElementById("qrLabel").value;

      qr.update({
        data,
        dotsOptions: { color },
        backgroundOptions: { color: bgColor },
      });

      const container = document.getElementById("qr-container");
      container.innerHTML = "";
      qr.append(container);

      document.getElementById("qr-label-output").innerText = label || "";
    }

    function toggleFields() {
      const type = document.getElementById("qrType").value;
      const container = document.getElementById("qrFields");
      const templates = {
        text: `<input id="qrText" type="text" placeholder="Enter text or URL" oninput="updateQR()" />`,
        wifi: `
          <input id="wifiSSID" type="text" placeholder="WiFi SSID" oninput="updateQR()" />
          <input id="wifiPass" type="text" placeholder="WiFi Password" oninput="updateQR()" />
          <select id="wifiSec" onchange="updateQR()">
            <option value="WPA">WPA/WPA2</option>
            <option value="WEP">WEP</option>
            <option value="nopass">No Password</option>
          </select>`,
        email: `
          <input id="emailTo" type="email" placeholder="Recipient Email" oninput="updateQR()" />
          <input id="emailSubject" type="text" placeholder="Email Subject" oninput="updateQR()" />`,
        sms: `
          <input id="smsNum" type="tel" placeholder="Phone Number" oninput="updateQR()" />
          <input id="smsMsg" type="text" placeholder="Message" oninput="updateQR()" />`,
        phone: `<input id="phoneNum" type="tel" placeholder="Phone Number" oninput="updateQR()" />`,
      };
      container.innerHTML = templates[type];
    }

    function toggleTheme() {
      const html = document.documentElement;
      html.dataset.theme = html.dataset.theme === "dark" ? "light" : "dark";
    }

    function downloadQR(format) {
      qr.download({ name: "qr-code", extension: format });
    }

    function loadLogo(input) {
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function (e) {
          qr.update({
            image: e.target.result,
          });
          updateQR();
        };
        reader.readAsDataURL(input.files[0]);
      }
    }

    toggleFields();
    updateQR();
  </script>
</body>
</html>
